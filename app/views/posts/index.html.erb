<% if !user_signed_in?%>
  <% controller.redirect_to "/" %>
<% end %>

<%= render "layouts/navbar" %>

<section id="page_container">

  <section id="user_info_box">
    <h3><strong><%= current_user.name %></strong></h3><br>
    <% if User.find(current_user.id).avatar.attached? %>
			<%= image_tag url_for(User.find(current_user.id).avatar), class: %w(post_image_size)%>
    <% else %>
      <%= image_tag "unknown.png", class: %w(post_image_size) %>
		<% end %>
    
    <div id="profile-info">
      <p><br>Country: <strong><%= current_user.country %></strong></p>
      <p>Language(s): <strong><%= current_user.languages %></strong></p>
      <p>IDE: <strong><%= current_user.ide %></strong></p><br>
    </div>
    <h1>
      <a href="<%= current_user.github %>" target="_blank" rel="noopener noreferrer"><i class="fab fa-github"></i></a> 
      <a href="<%= current_user.twitter %>" target="_blank" rel="noopener noreferrer"><i class="fab fa-twitter"></i></a>
      <a href="<%= current_user.linkedin %>" target="_blank" rel="noopener noreferrer"><i class="fab fa-linkedin-in"></i></a>
    </h1>
  </section>

  <section id="new_post_container">
		<section id="new_post">
			<%= form_for @post do |form| %>
      <textarea placeholder="What's on your mind?" <%= form.text_area :message %> 
      <div id="new_post_button" class="btn"><i class="fas fa-pencil-alt"></i>
      <%= form.submit 'Post' %></div>
      <% end %>
		</section>
  </section>
                			
  <% @posts.each do |post| %>
    <% next if post.user_id != current_user.id %>
    <% user_id = post.user_id %>
    <section id="post_container">
    <div>
	  <p><%= post.name %></p>
	    <% if User.find(user_id).avatar.attached? %>
			<%= image_tag url_for(User.find(user_id).avatar ), class: %w(post_image_size)%>
    <% else %>
      <%= image_tag "unknown.png", class: %w(post_image_size) %>
		<% end %>
    </div>

    <div>
      <p><%= post.created_at.localtime.strftime("%H:%M") %></p>
      <p><%= post.created_at.localtime.strftime("%d/%m/%y") %></p>
    </div>

    <div id="message">
    <p><strong><%= simple_format(post.message) %></strong></p>
    </div>

  <%= link_to 'Edit post', edit_post_path(post.id) %><br>
  <%= link_to 'Delete post', post_path(post.id), method: :delete, data: { confirm: "Are you sure you want to delete?" } %>
 
  </section>
  <% end %>

</section>


